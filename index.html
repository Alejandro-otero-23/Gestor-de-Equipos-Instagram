<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Contactos Instagram</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Librer√≠a para exportar a Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        .status-pendiente { background-color: #f3f4f6; color: #374151; border: 1px solid #d1d5db; }
        .status-enviado { background-color: #ebf8ff; color: #2b6cb0; border: 1px solid #bee3f8; }
        .status-conversacion { background-color: #f0fff4; color: #2f855a; border: 1px solid #c6f6d5; }
        .status-rechazado { background-color: #fff5f5; color: #c53030; border: 1px solid #fed7d7; }
        .status-finalizado { background-color: #faf5ff; color: #6b46c1; border: 1px solid #e9d8fd; }
        
        select.status-select {
            appearance: none;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 700;
            cursor: pointer;
            outline: none;
            transition: all 0.2s;
            min-width: 160px;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 md:p-8">
    <div class="max-w-6xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
        <div class="p-6 border-b border-gray-200 flex flex-col md:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-2xl font-bold text-gray-800">üìã Registro de Equipos IG</h1>
                <p class="text-gray-500">Organiza tus contactos y exporta a Excel</p>
            </div>
            <div class="flex gap-2">
                <button onclick="exportToExcel()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition shadow-sm font-semibold">
                    <span>üì• Descargar Excel</span>
                </button>
            </div>
        </div>

        <!-- Formulario de Entrada -->
        <div class="p-6 bg-gray-50 border-b border-gray-200">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <input type="text" id="teamName" placeholder="Nombre del Equipo" class="p-2 border rounded-md focus:ring-2 focus:ring-blue-400 outline-none">
                <input type="text" id="igUser" placeholder="Usuario (@ejemplo)" class="p-2 border rounded-md focus:ring-2 focus:ring-blue-400 outline-none">
                <select id="status" class="p-2 border rounded-md bg-white">
                    <option value="Pendiente">üïí Pendiente</option>
                    <option value="Enviado">üì© Enviado</option>
                    <option value="En Conversaci√≥n">üí¨ En Conversaci√≥n</option>
                    <option value="Rechazado">‚ùå Rechazado</option>
                    <option value="Finalizado">‚úÖ Finalizado</option>
                </select>
                <button onclick="addRow()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                    + Agregar Equipo
                </button>
            </div>
        </div>

        <!-- Tabla -->
        <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse" id="mainTable">
                <thead>
                    <tr class="bg-gray-100 text-gray-600 uppercase text-xs font-semibold">
                        <th class="px-6 py-4 border-b">Equipo</th>
                        <th class="px-6 py-4 border-b">Instagram</th>
                        <th class="px-6 py-4 border-b">Estado</th>
                        <th class="px-6 py-4 border-b">Acciones</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Fila de ejemplo con iconos -->
                    <tr class="hover:bg-gray-50 transition">
                        <td class="px-6 py-4 border-b font-medium">Ejemplo Team</td>
                        <td class="px-6 py-4 border-b text-blue-600 font-semibold italic"><a href="https://instagram.com/ejemplo" target="_blank">@ejemplo</a></td>
                        <td class="px-6 py-4 border-b">
                            <select onchange="updateStatusStyle(this)" class="status-select status-enviado">
                                <option value="Pendiente">üïí Pendiente</option>
                                <option value="Enviado" selected>üì© Enviado</option>
                                <option value="En Conversaci√≥n">üí¨ En Conversaci√≥n</option>
                                <option value="Rechazado">‚ùå Rechazado</option>
                                <option value="Finalizado">‚úÖ Finalizado</option>
                            </select>
                        </td>
                        <td class="px-6 py-4 border-b"><button onclick="deleteRow(this)" class="text-red-500 hover:text-red-700 font-bold text-sm">Eliminar</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        function getStatusClass(status) {
            // Limpia el texto de emojis y espacios para la clase CSS
            const cleanStatus = status.split(' ').pop().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            return "status-" + cleanStatus;
        }

        function updateStatusStyle(selectElement) {
            selectElement.className = "status-select";
            const statusValue = selectElement.value;
            
            if (statusValue.includes("Pendiente")) selectElement.classList.add("status-pendiente");
            if (statusValue.includes("Enviado")) selectElement.classList.add("status-enviado");
            if (statusValue.includes("En Conversaci√≥n")) selectElement.classList.add("status-conversacion");
            if (statusValue.includes("Rechazado")) selectElement.classList.add("status-rechazado");
            if (statusValue.includes("Finalizado")) selectElement.classList.add("status-finalizado");
        }

        function addRow() {
            const teamName = document.getElementById('teamName').value;
            let igUser = document.getElementById('igUser').value.replace('@', '');
            const status = document.getElementById('status').value;

            if (!teamName || !igUser) {
                alert("Por favor completa los campos de Equipo y Usuario.");
                return;
            }

            const tableBody = document.getElementById('tableBody');
            const row = document.createElement('tr');
            row.className = "hover:bg-gray-50 transition";
            
            // Determinar clase inicial
            let statusClass = "status-pendiente";
            if (status.includes("Enviado")) statusClass = "status-enviado";
            if (status.includes("En Conversaci√≥n")) statusClass = "status-conversacion";
            if (status.includes("Rechazado")) statusClass = "status-rechazado";
            if (status.includes("Finalizado")) statusClass = "status-finalizado";

            row.innerHTML = `
                <td class="px-6 py-4 border-b font-medium">${teamName}</td>
                <td class="px-6 py-4 border-b text-blue-600 font-semibold italic"><a href="https://instagram.com/${igUser}" target="_blank">@${igUser}</a></td>
                <td class="px-6 py-4 border-b">
                    <select onchange="updateStatusStyle(this)" class="status-select ${statusClass}">
                        <option value="Pendiente" ${status.includes('Pendiente') ? 'selected' : ''}>üïí Pendiente</option>
                        <option value="Enviado" ${status.includes('Enviado') ? 'selected' : ''}>üì© Enviado</option>
                        <option value="En Conversaci√≥n" ${status.includes('Conversaci√≥n') ? 'selected' : ''}>üí¨ En Conversaci√≥n</option>
                        <option value="Rechazado" ${status.includes('Rechazado') ? 'selected' : ''}>‚ùå Rechazado</option>
                        <option value="Finalizado" ${status.includes('Finalizado') ? 'selected' : ''}>‚úÖ Finalizado</option>
                    </select>
                </td>
                <td class="px-6 py-4 border-b"><button onclick="deleteRow(this)" class="text-red-500 hover:text-red-700 font-bold text-sm">Eliminar</button></td>
            `;

            tableBody.appendChild(row);
            document.getElementById('teamName').value = '';
            document.getElementById('igUser').value = '';
        }

        function deleteRow(btn) {
            btn.closest('tr').remove();
        }

        function exportToExcel() {
            const data = [["Equipo", "Instagram", "Estado"]];
            const trs = document.querySelectorAll('#tableBody tr');
            
            trs.forEach(tr => {
                const team = tr.cells[0].innerText;
                const ig = tr.cells[1].innerText;
                const status = tr.cells[2].querySelector('select').value;
                data.push([team, ig, status]);
            });

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Equipos IG");
            XLSX.writeFile(wb, "Registro_Equipos_Instagram.xlsx");
        }
    </script>
</body>
</html>
